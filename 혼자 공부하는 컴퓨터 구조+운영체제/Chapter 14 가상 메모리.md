## 14-1 연속 메모리 할당
- 연속 메모리 할당 : 프로세스에 연속적인 메모리 공간을 할당하는 방식

### 스와핑
- 현재 실행되지 않는 프로세스를 임시로 보조기억장치 일부 영역으로 쫓아내고, 빈 공간에 또 다른 프로세스를 적재하여 실행하는 방식
- 프로세스들이 쫒겨 나는 보조기억장치의 일부 영역을 스왑 영역이라 한다.
- 실행되지 않는 프로세스가 메모리에서 스왑 영역으로 옮겨지는 것을 스왑 아웃, 스왑 영역에 있던 프로세스가 다시 메모리로 옮겨오는 것을 스왑 인이라고 한다.
- 이 과정에서 기존 물리 주소와 다르게 적재될 수 있다.

### 메모리 할당
비어 있는 메모리 공간에 프로세스를 연속적으로 할당하는 대표 방식 세 가지

**최초 적합**
- 최초 적합 방식은 프로세스가 적재될 수 있는 공간을 발견하는 즉시 메모리를 할당하는 방식
- 검색을 최소화
- 빠른 할당

**최적 적합**
- 프로세스가 적재될 수 있는 공간 중 가장 작은 공간에 프로세스를 배치하는 방식

**최악 적합**
- 프로세스가 적재될 수 있는 공간 중 가장 큰 공간에 프로세스를 배치하는 방식

### 외부 단편화
- 연속 메모리 할당은 외부 단편화라는 문제가 있으므로 메모리를 효율적으로 사용하는 방법이 아니다.
- 프로세스를 할당하기 어려울 만큼 작은 메모리 공간들로 인해 메모리가 낭비되는 현상
- 외부 단편화를 해결할 수 있는 대표적인 방안은 압축
	- 메모리 조각 모음이라고도 부름
	- 여기저기 흩어져 있는 빈 공간들을 하나로 모으는 방식
	- 압축하는 동안 시스템은 중지돼야 하며 오버헤드 발생
	- 압축에 대한 방법을 결정하기 어려움

## 14-2 페이징을 통한 가상 메모리 관리
- 연속적으로 할당하는 방식은 두 가지 문제를 내포
	- 외부 단편화
	- 물리 메모리보다 큰 프로세스를 실행할 수 없다.
- 가상 메모리는 실행하고자 하는 프로그램을 일부만 메모리에 적재하여 실제 물리 메모리크기보다 더 큰 프로세스를 실행할 수 있게 하는 기술
	- 페이징 기법, 세그멘테이션 기법

### 페이징이란
- 페이징은 메모리의 물리 주소 공간을 프레임 단위로 자르고, 프로세스의 논리 주소 공간을 페이지 단위로 자른 뒤 각 페이지를 프레임에 할당하는 가상 메모리 관리 기법
- 페이징에서도 스와핑 사용 가능
	- 페이지 단위로 스압 아웃/인
	- 페이지 아웃, 페이지 인이라고도 부름

### 페이지 테이블
- 프로세스가 메모리에 불연속적으로 배치되면 CPU 입장에서 다음에 실행할 명령어 위치를 찾기 어려워짐
- 따라서 논리 주소에는 연속적으로 배치되도록 페이지 테이블을 이용
- 페이지 번호와 프레임 번호를 짝지어 주는 이정표
- 페이지 테이블 베이스 레지스터(PTBR)는 각 프로세스의 페이지 테이블이 적재된 주소를 가리키고 있다.
- 페이지 테이블을 메모리에 두면 접근 시간이 두 배로 늘어나는 단점이 발생
	- CPU 곁에 TLB라는 페이지 테이블의 캐시 메모리를 둬서 해결
		- 참조 지역성에 근거해 주로 최근에 사용된 페이지 위주로 가져와 저장

### 페이징에서의 주소 변환
- 페이징 시스템에서는 모든 논리 주소가 기본적으로 페이지번호와 변위로 이루어져 있다.
- 페이지 번호 : 접근하고자 하는 페이지 번호
- 변위 : 접근하려는 주소가 프레임의 시작 번지로부터 얼만큼 떨어져 있는지를 알기 위한 정보

### 페이지 테이블 엔트리
- 페이지 테이블의 각각읠 행들을 페이지 테이블 엔트리라고 한다.
- 페이지 테이블 엔트리에는 유효 비트, 보호 비트, 참조 비트, 수정 비트 등 다른 중요한 정보들이 있다.

**유효 비트**
- 현재 페이지가 메모리에 적재되어 있는지 아니면 보조기억장치에 있는지를 알려주는 비트
- CPU가 유효 비트가 0인 메모리에 적재되어 있지 않은 페이지로 접근하려고 하면 페이지 폴트라는 예외가 발생

**부호 비트**
- 페이지 보호 기능을 위해 존재
- 해당 페이지가 읽고 쓰기가 가능한 페이지인지 나타낼 수 있다.

**참조 비트**
- CPU가 접근한 적이 있는지 여부

**수정 비트**
- 해당 페이지에 데이터를 쓴 적이 있는지 없는지 수정 여부를 알려준다.
- 더티 비트라고도 부름

## 14-3 페이지 교체와 프레임 할당
### 요구 페이징
- 필요한 페이지만을 메모리에 적재하는 기법을 요구 페이징이라고 한다.
- 순수 요구 페이징
	- 아무런 페이지도 메모리에 적재하지 않은 채 실행 -> 페이지 폴트가 순차적으로 발생 -> 점점 페이지 폴트 빈도 감소
- 요구 페이징 시스템이 안정적으로 작동하려면 페이지 교체와, 프레임 할당을 해결해야 한다.
- 페이지 교체 알고리즘 : 쫒아낼 페이지를 결정하는 방법

### 페이지 교체 알고리즘
- 페이지 폴트를 가장 적게 일으키는 알고리즘을 좋은 알고리즘으로 평가
- 페이지 참조열 : CPU가 참조하는 페이지들 중 연속된 페이지를 생략한 페이지열
	- 페이지 폴트가 일어나지 않을 연속된 페이지에 대한 참조는 고려하지 않는다.

**FIFO 페이지 교체 알고리즘**
- 메모리에 가장 먼저 올라온 페이지부터 내쫓는 방식
- 아이디어와 구현이 간단
- 사용될 페이지를 내쫓을 수 있는 단점이 있음

**최적 페이지 교체 알고리즘**
- CPU에 의해 참조되는 횟수를 고려하는 페이지 교체 알고리즘
- 사용 빈도가 가장 낮은 페이지를 교체하는 알고리즘
- 가장 낮은 페이지 폴트율을 보장
- 실제 구현이 어렵다.

**LRU 페이지 교체 알고리즘**
- 가장 오랫동안 사용되지 '않은'페이지를 교체하는 알고리즘

### 스래싱과 프레임 할당
- 프로세스가 사용할 수 있는 프레임 수가 적어도 페이지 폴트는 자주 발생
- 프로세스가 실제 실행되는 시간보다 페이징에 더 많은 시간을 소요하여 성능이 저해되는 문제를 스래싱이라고 한다.
- 멀티프로그래밍의 정도 : 메모리에서 동시 실행되는 프로세스 수
- 스레싱이 발생하는 근본적인 원인은 각 프로세스가 필요로 하는 최소한의 프레임 수가 보장되지 않았기 때문
- 프레임 할당 방식
	- 균등 할당 : 모든 프로세스에 균등하게 프레임을 제공하는 방식
	- 비례 할당 : 프로세스 크기에 맞춰 프레임을 나눠 주는 방식
		- 완벽한 방식은 아니다
- 프로세스를 실행하는 과정에서 배분할 프레임을 결정하는 방식에는 크게 작업 집합 모델을 사용하는 방식과 페이지 폴트 빈로를 사용하는 방식이 있다.
- 작업 집합 모델
	- 실행 중인 프로세스가 일정 시간 동안 참조한 페이지의 집합을 작업 집합이라고 한다.
	- 작업 집합의 크기만큼만 프레임을 할당
- 페이지 폴트 빈도
	- 페이지 폴트율에 상한선과 하한선을 정하고, 이 범위 안에서만 프레임을 할당하는 방식
