# 04. 역할, 책임, 협력
> 우리 모두를 합친 것보다 더 현명한 사람은 없다.
> - 켄 블랜차드
- 협력이라는 문맥이 객체의 행동 방식을 결정
	- 협력이 자리를 잡으면 저절로 객체의 행동이 드러남 -> 적절한 객체의 상태가 결정
- 개별적인 객체의 행동이나 상태가 아니라 객체들 간의 협력에 집중

## 협력
### 요청하고 응답하며 협력하는 사람들
- 협력은 한 사람이 다른 사람에게 도움을 요청할 때 시작
- 요청을 받은 사람은 필요한 지식이나 서비스를 제공하는 것으로 요청에 응답
- 협력은 다수의 요청과 응답으로 구성되며 전체적으로 협력은 다수의 연쇄적인 요청과 응답의 흐름으로 구성

## 책임
- 요청에 대해 대답해 줄 수 있거나, 적절한 행동을 할 의무가 있는 경우 해당 객체가 책임을 가진다고 말함

### 책임의 분류
- 객체의 책임은 '객체가 무엇을 알고 있는가(knowing)와 무엇을 할 수 있는가(doing)'로 구성된다.
```text
- 하는 것(doing)
	- 객체를 생성하거나 계산을 하는 등의 스스로 하는 것
	- 다른 객체의 행동을 시작시키는 것
	- 다른 객체의 활동을 제어하고 조절하는 것

- 아는 것(knowing)
	- 개인적인 정보에 관해 아는 것
	- 관련된 객체에 관해 아는 것
	- 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것
```

> 책임은 객체의 외부에 제공해 줄 수 있는 정보(아는 것의 측면)와 외부에 제공해 줄 수 있는 서비스(하는 것의 측면)의 목록이다.
> 책임은 객체의 공용 인터페이스(public interface)를 구성한다.

### 책임과 메시지
- 다른객체에게 주어진 책임을 수행하도록 요청을 보내는 것을 메시지 전송(message-send)라고 한다.
- 협력은 메시지를 통해 이뤄진다.
- 협력을 요청하는 객체를 송신자, 요청을 처리하는 객체를 수신자라고 한다.

## 역할
### 책임의 집합이 의미하는 것
- 객체가 수행하는 책임의 집합은 객체가 협력 안에서 수행하는 역할을 암시
	- 역할이 재사용 가능하고 유연한 객체지향 설계를 낳는 매우 중요한 구성요소

### 역할이 답이다
- 역할은 협력 내에서 다른 객체로 대체할 수 있도록 추상화 할 수 있다.
- 역할을 대체하기 위해서는 각 역할이 수신할 수 있는 메시지를 동일한 방식으로 이해해야 한다.

> 동일한 역할 수행 = 동일한 메시지 수신 = 동일한 책임 수행

- 역할은 객체지향 설계의 단순성(simplicity), 유연성(flexibility), 재사용성(reusability)을 뒷받침하는 핵심 개념

### 협력의 추상화
- 역학을 이용하면 협력을 추상화함으로써 단순화할 수 있다.

### 대체 가능성
- 역할은 다른 객체에 의해 대체 가능함을 의미
- 객체가 역할을 대체 가능하기 위해서는 협력 안에서 역할이 수행하는 모든 책임을 동일하게 수행할 수 있어야 한다.
- 객체는 역할이 암시하는 책임보다 더 많은 책임을 가질 수 있음
	- 대부분의 경우 객체의 타입과 역할 사이에는 `일반화/특수화 관계`가 성립하는 것이 일반적임
		- 역할은 일반화
		- 객체의 타입은 특수화
- 역할 자체가 객체의 추상화

## 객체의 모양을 결정하는 협력
### 흔한 오류
- 시스템에 필요한 데이터를 저장하기 위해 객체가 존재한다는 선입견
- 객체지향이 클래스와 클래스 간의 관계를 표현하는 시스템의 정적인 측면에 중점을 둔다는 선입견
- 이렇게 데이터나 클래스를 중심으로 애플리케이션을 설계하는 이유는 협력이라는 문맥을 고려하지 않고 각 객체를 독립적으로 바라보기 때문

### 협력을 따라 흐르는 객체의 책임
- 협력 설계 = 객체들이 주고받을 요청과 응답의 흐름을 결정 -> 객체가 협력에 참여하기 위해 수행될 책임
- 협력 설계 -> 책임, 행동 결정 -> 객체에게 할당 -> 클레스 구현 및 데이터 설계

## 객체지향 설계 기법
역할, 책임, 협력의 관점에서 애플리케이션을 설계하는 유용한 세 가지 기법

- 책임-주도 설계(Responsibility-Driven Design) 방법은 협력에 필요한 책임들을 식별하고 적합한 객체에게 책임을 할당하는 방식
- 디자인 패턴(Design Pattern)은 전문가들이 반복적으로 사용하는 해결 방법을 정의해 놓은 설계 템플릿 모음
	- 패턴은 전문가들이 특정 문제를 해결하기 위해 이미 식별해 놓은 역할, 책임, 협력의 모음
- 테스트-주도 개발(Test-Driven Development)은 테스트를 먼저 작성하고 테스트를 통과하는 구체적인 코드를 추가하면서 애플리케이션을 완성해가는 방식
	- 실제 목적은 구체적인 코드를 작성해나가면서 역할, 책임, 협력을 식별하고 식별된 역할, 책임, 협력이 적합한지를 피드백받는 것

### 책임-주도 설계
1. 시스템 기능은 더작은 규모의 책임으로 분할
2. 각 책임은 책임을 수행할 적절한 객체에게 할당
3. 객체가 책임을 수행하는 도중 협력이 필요할 때 적절한 객체에게 작업을 요청
4. 해당 작업은 위임받은 객ㅊ레의 책임으로 변환
5. 객체들 간의 협력 관계 생성
- 만약 책임을 여러 종류의 객체가 수행할 수 있다면 협력자는 객체가 아니라 추상적인 역할로 대체

> 책임-주도 설계는 이러한 순차적인 방식으로 객체들의 협력 공동체를 구축하며 객체의 책임과 상호작용에 집중

- 객체지향 시스템을 설계하는 절차
```
- 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악.
- 시스템 책임을 더 작은 책임으로 분할
- 분할된 책임을 수행할 수 있는 적절한 객ㅊ레 또는 역할을 찾아 책임을 할당
- 객체가 책임을 수행하는 중에 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾음
- 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 됨
```
- 책임-주도 설계는 객체의 역할, 책임, 협력을 고안하기 위한 방법과 절차를 제시

### 디자인 패턴
- 디자인 패턴은 책임-주도 설계의 결과를 표현
	- 패턴은 모범이 되는 설계
- 디자인 패턴은 반복적으로 발생하는 문제와 그 문제에 대한 해법의 쌍으로 정의
- 디자인 패턴은 책임-주도 설계의 결과물인 동시에 지름길

### 테스트-주도 개발
- 기본 흐름
	- 실패하는 테스트 작성
	- 통과하는 가장 간단한 코드 작성
	- 리팩터링을 통해 중복 제거
	- '작동하는 깔끔한 코드'가 목적
- 테스트-주도 개발은 책임-주도 설계를 통해 도달해야 하는 목적지를 테스트라는 안전장치를 통해 좀 더 빠르고 견고한 방법으로 도달할 수 있또록 해주는 최상의 설계 프랙티스
- 테스트-주도 개발은 책임-주도 설계의 기본 개념과 다양한 원칙과 프랙티스, 패턴을 종합적으로 이해하고 좋은 설계에 대한 감각과 경험을 길러얗만 적용할 수 있는 설계 기법