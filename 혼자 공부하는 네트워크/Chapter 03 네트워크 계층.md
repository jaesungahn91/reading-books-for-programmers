## 03-1 LAN을 넘어서는 네트워크 계층
### 데이터 링크 계층의 한계
- 물리 계층과 데이터 링크 계층만으로는 다른 네트워크까지의 도달 경로를 파악하기 어렵다.
	- 패킷이 이동할 최적의 경로를 결정하는 것을 라우팅이라고 한다.
	- 라우팅을 수행하는 대표적인 장비로는 라우터가 있다.
- MAC 주소만으로는 모든 네트워크에 속한 호스트의 위치를 특정하기 어렵다.
	- 수신지의 역할을 하는 정보는 네트워크 계층의 IP주소
	- MAC주소를 물리주소, IP주소를 논리 주소라고도 부른다.
### 인터넷 프로토콜
- 네트워크 게층의 가장 핵심적인 프로토콜 하나는 인터넷 프로토콜이다.
	- IP버전 4(IPv4)와 IP버전 6(IPv6), 두 가지 버전이 있다.
- IP 주소는 4바이트(32비트)로 주소를 표현할 수 있고, 숫자당 8비트로 표현되기에 0~255 범위 안에 있는 네 개의 10진수로 표기된다.
	- 점으로 구분된 8비트를 옥텟이라고 한다.
- IP의 대표적인 기능에는 크게 IP 주소 지정과 IP 단편화가 있다.
	- IP 주소 지정은 IP 주소를 바탕으로 송수신 대상을 지정하는 것을 의미
	- IP 단편화는 전송하고자 하는 패킷의 크기가 MTU라는 최대 전송 단위보다 클 경우, 이를 MTU 크기 이하의 복수의 패킷으로 나누는 것을 의미한다.

**IPv4**
- IPv4 패킷은 프레임의 페이로드로 데이터 필드에 명시된다.
- 식별자, 플래그, 단편화 오프셋 필드는 IP 단편화 기능에 관여하고, 송신지 IP 주소, 수신지 IP 주소는 IP 주소 지정 기능에 관여한다.
```
- 식별자 : 패킷에 할당된 번호
- 플래그 : 총 세 개의 비트로 구성된 필드(DF, MF)
- 단편화 오프셋 : 패킷이 단편화되기 전에 패킷의 초기 데이터에서 몇 번째로 떨어진 패킷인지 나타냄
- TTL : 패킷의 수명(홉 단위)
- 프로토콜 : 상위 계층의 프로토콜이 무엇인지를 나타내는 필드
- 송신지 IP 주소 수신지 IP 주소
```

**IPv6**
- 43억 개라는 IPv4의주소의 총량의 고갈문제 떄문에 등장한 버전
- 16바이트로 주소를 표현할 수 있고, 콜론으로 구분된 8개 그룹의 16진수로 표기
- 기본 헤더는 IPv4에 비해 간소화
```
- 다음 헤더 : 상위 계층의 프로토콜을 가리키거나 확장 헤더를 가르킨다. 추가적인 헤더 정보가 필요할 경우에 기본헤더와 더불어 확장 헤더라는 추가 헤더를 가질 수 있다.
- 홉 제한 : 패킷의 수명을 나타내는 필드
- 송신지 IP 주소와 수신지 IP 주소
```

### ARP
- IP 주소를 통해 MAC 주소를 알아내는 프로토콜
- ARP의 동작과정
	- ARP 요청 : 같은 내트워크 내의 모든 호스트에게 브로드캐스트 메시지를 보낸다.
	- ARP 응답
	- ARP 테이블 갱신

## 03-2 IP 주소
- 하나의 IP 주소는 크게 네트워크 주소와 호스트 주소로 이루어진다.
### 네트워크 주소와 호스트 주소
- 네트워크 주소는 네트워크 ID, 네트워크 식별자 등으로 부르기도 하며, 호스트 주소는 호스트 ID, 호스트 식별자 등으로 부른다.
- IP 주소에서 네트워크 주소와 호스트 주소를 구분하는 범위는 유동적이다.
### 클래스풀 주소 체계
- 클래스는 네트워크크기에 따라 IP 주소를 분류하는 기준
- 클래스를 기반으로 IP 주소를 관리하는 주소 쳬계를 클래스풀 주소 체계라고 한다.
```
- A 클래스 : 8/24
- B 클래스 : 16/16
- C 클래스 : 24/8
```
### 클래스 리스 주소 체계
- 이름처럼 클래스 개념 없이 클래스에 구애받지 않고 네트워크의 영역을 나누어서 호스트에게 IP 주소 공간을 할당하는 방식
- 클래스리스 주소 체계에서는 네트워크와 호스트를 구분 짓는 수단으로 서브넷 마스크를 이요한다.
- 서브넷 마스크는 IP 주소상에서 네트워크 주소는 1, 호스트 주소는 0으로 표기한 비트열열을 의미
- 서브넷 마스크를 이용해 슼ㄹ래스를 원하는 크기로 더 잘게 쪼개어 사용하는 것을 서브네팅이라고 한다.
- 서브넷 마스크를 이용해 네트워크 주소와 호스트 주소를 구분 짓는 방법은 IP 주소와 서브넷 마스크를 비트 AND 연산을 하면 된다.
- 서브넷 마스크를 표기하는 방법
	- 10진수로 표기하는 방법
	- IP 주소/서브넷 마스크상의 1의 개수 형식으로 표기하는 방법 = CIDR 표기법
### 공인 IP 주소와 사설 IP 주소
**공인 IP 주소**
- 전 세계에서 고유한 IP 주소
- ISP나 공인 IP 주소할당 기관을 통해 할당 받을 수 있다.

**사설 IP 주소와 NAT**
- 사설 네트워크에서 사용하기 위한 IP 주소
- 외부 네트워크에 공개되지 않은 네트워크를 의미
- 사설 IP 주소로 사용하도록 특별히 예약된 IP 주소 공간
	- 10.0.0.0/8
	- 172.16.0.0/12
	- 192.168.0.0/16
- 사설 IP 주소 할당 주체는 일반적으로 라우터
- NAT(Network Address Translation)는 IP 주소를 변환하는 기술
### 정적 IP 주소와 동적 IP 주소
**정적 할당**
- 호스트에 직접 수작업으로 IP 주소를 부여하는 방식
- 정적 IP 주소

**동적 할당과 DHCP**
- 정적 할당과는 달리 IP 주소를 직접 일일이 입력하지 않아도 호스트에 IP 주소가 동적으로 할당되는 방식
- 동적 IP 주소
- IP 동적 할당에 사용되는 대표적인 프로토콜이 바로 DHCP(Dynamic Host Configuration Protocol)
	- IP 주소를 제공하는 DHCP 서버가 필요
	- DHCP 서버의 역할은 일반적으로 라우터(공유기)가 수행
- 클라이언트와 DHCP 서버 간에 주고받는 메시지 종류
	- DHCP Discover
	- DHCP Offer
	- DHCP Request
	- DHCP Acknowledgment

## 03-3 라우팅